<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="This is my personal blog">

        <meta property="og:title" content="Structures and clean code | José Postiga / Senior Backend Developer"/>
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://josepostiga.com/journal/2019-02-11-structures-and-clean-code"/>
        <meta property="og:description" content="This is my personal blog" />

        <title>José Postiga / Senior Backend Developer | Structures and clean code</title>

        <link rel="home" href="https://josepostiga.com">
        <link rel="icon" href="/favicon.ico">
        <link href="/blog/feed.atom" type="application/atom+xml" rel="alternate" title="José Postiga / Senior Backend Developer Atom Feed">

            <meta property="og:title" content="Structures and clean code" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://josepostiga.com/journal/2019-02-11-structures-and-clean-code"/>
    <meta property="og:description" content="" />

        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=30240e039ac150452ca0">
    </head>

    <body class="flex flex-col justify-between min-h-screen bg-grey-lightest text-grey-darkest leading-normal font-sans">
        <header class="flex items-center shadow bg-white border-b h-24 py-4" role="banner">
            <div class="container flex items-center max-w-xl mx-auto px-6">
                <nav class="hidden lg:flex items-center justify-end text-lg">
                    <a title="José Postiga / Senior Backend Developer" href="/" class="mr-6 text-grey-darker hover:text-blue-dark ">
                        About
                    </a>

                    <a title="José Postiga / Senior Backend Developer Journal" href="/journal" class="mr-6 text-grey-darker hover:text-blue-dark ">
                        Journal
                    </a>

                    <a title="José Postiga / Senior Backend Developer Articles" href="/articles" class="mr-6 text-grey-darker hover:text-blue-dark ">
                        Articles
                    </a>
                </nav>

                <div id="vue-search" class="flex flex-1 justify-end items-center">
                    <search></search>
                </div>
            </div>
        </header>

        <main role="main" class="flex-auto w-full container max-w-xl mx-auto py-16 px-6">
                        <img src="https://c10.patreonusercontent.com/3/eyJ3IjoxNjAwfQ%3D%3D/patreon-media/p/post/24634449/b0e9e612192d4bd5ac6d476e4f4765a7/4?token-time=1552176000&amp;token-hash=bZdn8gqyfAXVPmv-bh8jBy8mu2wJ6Lg7LVF4Bdc8j_g%3D" alt="Structures and clean code cover image" class="mb-2 w-full">
    
    <h1 class="leading-none mt-1 mb-2">Structures and clean code</h1>

    <p class="text-grey-darker text-xl md:mt-0">José Postiga  •  11/02/2019</p>

    <div class="mb-10 pb-4" v-pre>
        <p>Hey there! How was your weekend? Ready for another week full of opportunities?</p>
<p>Today I started my day reading the powerful, insightful and intriguing book &quot;Clean Code&quot;, by Robert C. &quot;Uncle Bob&quot; Martin. I'm still a couple chapters in but I'm already hooked on the premise of analysing code and understanding the common pitfalls of programming. The level of details and narrative shows a lot of commitment to trying to make us (programmers) more thoughtful on our daily work. I sure am learning something new at each paragraph.</p>
<p>With all this inspiration. as soon as I entered the office, I went deep on that reporting class I've been working since last week. Now that I have the foundations (the &quot;world&quot;, as I referred on my last post), I rapidly added the tests necessary to validate the structure of that report. However, something were to keep me occupied for the most part of the morning: configurations.</p>
<p>I had been having trouble configuring PHPstorm to run my test suite directly on it. If you have PHPstorm and have a test class opened, you can click on the green arrow, on the left side of the test function's name, and let the IDE run the test through PHPUnit and output the result. After the first run (which should fail) you can rapidly re-execute it by clicking ctrl+F5 (on Windows/Linux). This workflow is better than going to the console, accessing the history to show past executed commands and run the command to test a function/entire class. And so, I spent the next hour and a half configuring a remote PHP interpreter with Docker, configuring PHPUnit to use a custom configuration file (under the tests folder) and going back and forth with little mistakes, along the way.</p>
<p>After I got it to work properly, I started creating the different tests for each important part of the report's response structure. I knew I could use two special functions, for this: &quot;assertJsonStructure()&quot; and &quot;assertJsonFragment()&quot;. I've never used them much, before, but the work I was doing was a perfect use case for these functions.</p>
<p>By using the &quot;assertJsonStructure()&quot;, I can validate that a given response has the required structure, by checking if the defined keys are present.  On the other hand, &quot;assertJsonFragment()&quot; validates that the response contains the given information, by checking not only the keys but also its values. Here's an example of how I used the two to test for a valid response:</p>
<p><img src="https://c10.patreonusercontent.com/3/eyJ3IjoxMjQwfQ%3D%3D/patreon-media/p/post/24634449/d41e4f5f3a92466db06ffa8c9a478df7/1?token-time=1552176000&amp;token-hash=xnwuQJGC_-TRg7bq5ROf7V0gIG0aa5F4n7KEd642tkM%3D" alt="" /></p>
<p>As you can see, the &quot;AssertJsonStructure()&quot; is checking the response of the &quot;getJson()&quot; for the existence of the keys I defined as required. Now note that I'm not checking the keys' values, but only that the structure is as defined. The values are checked on the &quot;assertJsonFragment()&quot; where it's checked that the response has the given fragment somewhere. Alone, these assertions are prone to false positives but together they make a pretty good enforcing of the necessary structure of the response. Pretty neat, I think!</p>
<p>I’m yet to finish this, but I can say I'm halfway through it. The best of all, I've been refactoring my solution along the way, and the tests let me do it with confidence that I won’t break anything. Awesome!</p>
<p>But let's talk about another thing, now: HUB. I've worked on it, this weekend. I finally finished the feature tests for the user's profile update and also finished the create and update part of the CRUD functionality. I'm on the delete part, the last one before finishing this module. Another thing I've done, too, is to change the project, a little bit. I will be creating this as an API first software (or headless, one term you might already hear of). This decision will remove the need to think of a design to ship with the product when I release it to the World (MIT licensed). This way, anyone can create the frontend on their preferred technology. Also, as a bonus, when I finish the API part, I can practice the frontend part myself, as a separate project.</p>    </div>

    <nav class="flex justify-between text-sm md:text-base">
        <div>
                            <a href="https://josepostiga.com/journal/2019-02-09-small-firm-steps" title="Older Post: Small, firm, steps">
                    &LeftArrow; Small, firm, steps
                </a>
                    </div>

        <div>
                            <a href="https://josepostiga.com/journal/2019-02-12-reactive-vs-proactive" title="Newer Post: Reactive VS Proactive">
                    Reactive VS Proactive &RightArrow;
                </a>
                    </div>
    </nav>
        </main>

        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-reset">
                <li class="md:mr-2">
                    &copy; José Postiga 2019.
                </li>

                <li>
                    Built with <a href="http://jigsaw.tighten.co" title="Jigsaw by Tighten">Jigsaw</a>
                    and <a href="https://tailwindcss.com" title="Tailwind CSS, a utility-first CSS framework">Tailwind CSS</a>.
                    Theme &copy; <a href="https://tighten.co" title="Tighten website">Tighten</a>
                </li>
            </ul>
        </footer>

        <script src="/assets/build/js/main.js?id=a6021ca9737bdcd39961"></script>

            </body>
</html>
